<?xml version='1.0'?>
<html xmlns='http://www.w3.org/1999/xhtml'
      xmlns:math='http://www.w3.org/1998/Math/MathML'
>
<head>
<title>AD Theory for Cholesky Factorization</title>
<meta http-equiv='Content-Type' content='text/html' charset='utf-8'/>
<meta name="description" id="description" content="AD Theory for Cholesky Factorization"/>
<meta name="keywords" id="keywords" content=" ad theory cholesky factorization reference notation factor taylor coefficient lower triangular part forward mode lemma 1 proof 2 reverse case k = 0 &gt; "/>
<style type='text/css'>
body { color : black }
body { background-color : white }
A:link { color : blue }
A:visited { color : purple }
A:active { color : purple }
</style>
<script type='text/javascript' language='JavaScript' src='_cholesky_theory_xml.js'>
</script>
</head>
<body>
<table><tr>
<td>
<a href="http://www.coin-or.org/CppAD/" target="_top"><img border="0" src="_image.gif"/></a>
</td>
<td><a href="atomic_eigen_cholesky.cpp.xml" target="_top">Prev</a>
</td><td><a href="atomic_eigen_cholesky.hpp.xml" target="_top">Next</a>
</td><td>
<select onchange='choose_across0(this)'>
<option>Index-&gt;</option>
<option>contents</option>
<option>reference</option>
<option>index</option>
<option>search</option>
<option>external</option>
</select>
</td>
<td>
<select onchange='choose_up0(this)'>
<option>Up-&gt;</option>
<option>CppAD</option>
<option>AD</option>
<option>ADValued</option>
<option>atomic</option>
<option>atomic_base</option>
<option>atomic_eigen_cholesky.cpp</option>
<option>cholesky_theory</option>
</select>
</td>
<td>
<select onchange='choose_down3(this)'>
<option>atomic-&gt;</option>
<option>checkpoint</option>
<option>atomic_base</option>
</select>
</td>
<td>
<select onchange='choose_down2(this)'>
<option>atomic_base-&gt;</option>
<option>atomic_ctor</option>
<option>atomic_option</option>
<option>atomic_afun</option>
<option>atomic_forward</option>
<option>atomic_reverse</option>
<option>atomic_for_sparse_jac</option>
<option>atomic_rev_sparse_jac</option>
<option>atomic_for_sparse_hes</option>
<option>atomic_rev_sparse_hes</option>
<option>atomic_base_clear</option>
<option>atomic_get_started.cpp</option>
<option>atomic_norm_sq.cpp</option>
<option>atomic_reciprocal.cpp</option>
<option>atomic_set_sparsity.cpp</option>
<option>atomic_tangent.cpp</option>
<option>atomic_eigen_mat_mul.cpp</option>
<option>atomic_eigen_mat_inv.cpp</option>
<option>atomic_eigen_cholesky.cpp</option>
<option>atomic_mat_mul.cpp</option>
</select>
</td>
<td>
<select onchange='choose_down1(this)'>
<option>atomic_eigen_cholesky.cpp-&gt;</option>
<option>cholesky_theory</option>
<option>atomic_eigen_cholesky.hpp</option>
</select>
</td>
<td>cholesky_theory</td>
<td>
<select onchange='choose_current0(this)'>
<option>Headings-&gt;</option>
<option>Reference</option>
<option>Notation</option>
<option>---..Cholesky Factor</option>
<option>---..Taylor Coefficient</option>
<option>---..Lower Triangular Part</option>
<option>Forward Mode</option>
<option>Lemma 1</option>
<option>---..Proof</option>
<option>Lemma 2</option>
<option>Reverse Mode</option>
<option>---..Case k = 0</option>
<option>---..Case k &gt; 0</option>
</select>
</td>
</tr></table><br/>
<center><b><big><big>AD Theory for Cholesky Factorization</big></big></b></center>
<br/>
<b><big><a name="Reference" id="Reference">Reference</a></big></b>
<br/>
See section 3.6 of
Sebastian F. Walter's Ph.D. thesis,
<i>
Structured Higher-Order Algorithmic Differentiation
in the Forward and Reverse Mode
with Application in Optimum Experimental Design
</i>,
Humboldt-Universitat zu Berlin,
2011.


<br/>
<br/>
<b><big><a name="Notation" id="Notation">Notation</a></big></b>


<br/>
<br/>
<b><a name="Notation.Cholesky Factor" id="Notation.Cholesky Factor">Cholesky Factor</a></b>
<br/>
We are given a positive definite symmetric matrix

<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>A</mi>
<mo stretchy="false">&#x02208;</mo>
<msup><mrow><mstyle mathvariant='bold'><mi mathvariant='bold'>R</mi>
</mstyle></mrow>
<mrow><mi mathvariant='italic'>n</mi>
<mo stretchy="false">&#x000D7;</mo>
<mi mathvariant='italic'>n</mi>
</mrow>
</msup>
</mrow></math>


and a Cholesky factorization

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<mi mathvariant='italic'>A</mi>
<mo stretchy="false">=</mo>
<mi mathvariant='italic'>L</mi>
<msup><mi mathvariant='italic'>L</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msup>
</mrow></math>

where 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>L</mi>
<mo stretchy="false">&#x02208;</mo>
<msup><mrow><mstyle mathvariant='bold'><mi mathvariant='bold'>R</mi>
</mstyle></mrow>
<mrow><mi mathvariant='italic'>n</mi>
<mo stretchy="false">&#x000D7;</mo>
<mi mathvariant='italic'>n</mi>
</mrow>
</msup>
</mrow></math>

 is lower triangular.

<br/>
<br/>
<b><a name="Notation.Taylor Coefficient" id="Notation.Taylor Coefficient">Taylor Coefficient</a></b>
<br/>
The matrix 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>A</mi>
</mrow></math>

 is a function of a scalar argument

<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>t</mi>
</mrow></math>

.
For 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>k</mi>
<mo stretchy="false">=</mo>
<mn>0</mn>
<mo stretchy="false">,</mo>
<mo stretchy="false">&#x02026;</mo>
<mo stretchy="false">,</mo>
<mi mathvariant='italic'>K</mi>
</mrow></math>

, we use 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<msub><mi mathvariant='italic'>A</mi>
<mi mathvariant='italic'>k</mi>
</msub>
</mrow></math>

 for the
corresponding Taylor coefficients; i.e.,

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<mi mathvariant='italic'>A</mi>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>t</mi>
<mo stretchy="false">)</mo>
<mo stretchy="false">=</mo>
<mi mathvariant='italic'>o</mi>
<mo stretchy="false">(</mo>
<msup><mi mathvariant='italic'>t</mi>
<mi mathvariant='italic'>K</mi>
</msup>
<mo stretchy="false">)</mo>
<mo stretchy="false">+</mo>
<munderover><mo displaystyle='true' largeop='true'>&#x02211;</mo>
<mrow><mi mathvariant='italic'>k</mi>
<mo stretchy="false">=</mo>
<mn>0</mn>
</mrow>
<mi mathvariant='italic'>K</mi>
</munderover>
<msub><mi mathvariant='italic'>A</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<msup><mi mathvariant='italic'>t</mi>
<mi mathvariant='italic'>k</mi>
</msup>
</mrow></math>

where 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>o</mi>
<mo stretchy="false">(</mo>
<msup><mi mathvariant='italic'>t</mi>
<mi mathvariant='italic'>K</mi>
</msup>
<mo stretchy="false">)</mo>
<mo stretchy="false">/</mo>
<msup><mi mathvariant='italic'>t</mi>
<mi mathvariant='italic'>K</mi>
</msup>
<mo stretchy="false">&#x02192;</mo>
<mn>0</mn>
</mrow></math>

 as 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>t</mi>
<mo stretchy="false">&#x02192;</mo>
<mn>0</mn>
</mrow></math>

.
We use a similar notation for 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>L</mi>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>t</mi>
<mo stretchy="false">)</mo>
</mrow></math>

.

<br/>
<br/>
<b><a name="Notation.Lower Triangular Part" id="Notation.Lower Triangular Part">Lower Triangular Part</a></b>
<br/>
For a square matrix 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>C</mi>
</mrow></math>

,

<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>lower</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>C</mi>
<mo stretchy="false">)</mo>
</mrow></math>

 is the lower triangular part of 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>C</mi>
</mrow></math>

,

<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>diag</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>C</mi>
<mo stretchy="false">)</mo>
</mrow></math>

 is the diagonal matrix with the same diagonal as

<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>C</mi>
</mrow></math>

 and

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>low</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>C</mi>
<mo stretchy="false">)</mo>
<mo stretchy="false">=</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>lower</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>C</mi>
<mo stretchy="false">)</mo>
<mo stretchy="false">-</mo>
<mfrac><mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>diag</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>C</mi>
<mo stretchy="false">)</mo>
</mrow></math>

<br/>
<b><big><a name="Forward Mode" id="Forward Mode">Forward Mode</a></big></b>
<br/>
For Taylor coefficient order 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>k</mi>
<mo stretchy="false">=</mo>
<mn>0</mn>
<mo stretchy="false">,</mo>
<mo stretchy="false">&#x02026;</mo>
<mo stretchy="false">,</mo>
<mi mathvariant='italic'>K</mi>
</mrow></math>


the coefficients

<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<msub><mi mathvariant='italic'>A</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">&#x02208;</mo>
<msup><mrow><mstyle mathvariant='bold'><mi mathvariant='bold'>R</mi>
</mstyle></mrow>
<mrow><mi mathvariant='italic'>n</mi>
<mo stretchy="false">&#x000D7;</mo>
<mi mathvariant='italic'>n</mi>
</mrow>
</msup>
</mrow></math>

, and
satisfy the equation

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msub><mi mathvariant='italic'>A</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">=</mo>
<munderover><mo displaystyle='true' largeop='true'>&#x02211;</mo>
<mrow><mo stretchy="false">&#x02113;</mo>
<mo stretchy="false">=</mo>
<mn>0</mn>
</mrow>
<mi mathvariant='italic'>k</mi>
</munderover>
<msub><mi mathvariant='italic'>L</mi>
<mo stretchy="false">&#x02113;</mo>
</msub>
<msubsup><mi mathvariant='italic'>L</mi>
<mrow><mi mathvariant='italic'>k</mi>
<mo stretchy="false">-</mo>
<mo stretchy="false">&#x02113;</mo>
</mrow>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
</mrow></math>

In the case where 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>k</mi>
<mo stretchy="false">=</mo>
<mn>0</mn>
</mrow></math>

, the

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msub><mi mathvariant='italic'>A</mi>
<mn>0</mn>
</msub>
<mo stretchy="false">=</mo>
<msub><mi mathvariant='italic'>L</mi>
<mn>0</mn>
</msub>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
</mrow></math>

The value of 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<msub><mi mathvariant='italic'>L</mi>
<mn>0</mn>
</msub>
</mrow></math>

 can be computed using the Cholesky factorization.
In the case where 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>k</mi>
<mo stretchy="false">&gt;</mo>
<mn>0</mn>
</mrow></math>

,

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msub><mi mathvariant='italic'>A</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">=</mo>
<msub><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">+</mo>
<msub><mi mathvariant='italic'>L</mi>
<mn>0</mn>
</msub>
<msubsup><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">+</mo>
<msub><mi mathvariant='italic'>B</mi>
<mi mathvariant='italic'>k</mi>
</msub>
</mrow></math>

where

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msub><mi mathvariant='italic'>B</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">=</mo>
<munderover><mo displaystyle='true' largeop='true'>&#x02211;</mo>
<mrow><mo stretchy="false">&#x02113;</mo>
<mo stretchy="false">=</mo>
<mn>1</mn>
</mrow>
<mrow><mi mathvariant='italic'>k</mi>
<mn>-1</mn>
</mrow>
</munderover>
<msub><mi mathvariant='italic'>L</mi>
<mo stretchy="false">&#x02113;</mo>
</msub>
<msubsup><mi mathvariant='italic'>L</mi>
<mrow><mi mathvariant='italic'>k</mi>
<mo stretchy="false">-</mo>
<mo stretchy="false">&#x02113;</mo>
</mrow>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
</mrow></math>

Note that 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<msub><mi mathvariant='italic'>B</mi>
<mi mathvariant='italic'>k</mi>
</msub>
</mrow></math>

 is defined in terms of Taylor coefficients
of 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>L</mi>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>t</mi>
<mo stretchy="false">)</mo>
</mrow></math>

 that have order less than 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>k</mi>
</mrow></math>

.
We also note that

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
<mo stretchy="false">(</mo>
<msub><mi mathvariant='italic'>A</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">-</mo>
<msub><mi mathvariant='italic'>B</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">)</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mo stretchy="false">-</mo>
<mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">=</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
<msub><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">+</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mo stretchy="false">-</mo>
<mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
</mrow></math>

The first matrix on the right hand side is lower triangular,
the second is upper triangular,
and the diagonals are equal.
It follows that

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
<msub><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">=</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>low</mi>
</mstyle></mrow>
<mo stretchy="false">[</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
<mo stretchy="false">(</mo>
<msub><mi mathvariant='italic'>A</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">-</mo>
<msub><mi mathvariant='italic'>B</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">)</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mo stretchy="false">-</mo>
<mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">]</mo>
</mrow></math>


<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msub><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">=</mo>
<msub><mi mathvariant='italic'>L</mi>
<mn>0</mn>
</msub>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>low</mi>
</mstyle></mrow>
<mo stretchy="false">[</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
<mo stretchy="false">(</mo>
<msub><mi mathvariant='italic'>A</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">-</mo>
<msub><mi mathvariant='italic'>B</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">)</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mo stretchy="false">-</mo>
<mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">]</mo>
</mrow></math>

This expresses 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<msub><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
</msub>
</mrow></math>

 in term of the
Taylor coefficients of 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>A</mi>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>t</mi>
<mo stretchy="false">)</mo>
</mrow></math>

 and the lower order coefficients
of 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>L</mi>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>t</mi>
<mo stretchy="false">)</mo>
</mrow></math>

.

<br/>
<br/>
<b><big><a name="Lemma 1" id="Lemma 1">Lemma 1</a></big></b>
<br/>
We use the notation 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mover accent='false'><mrow><mi mathvariant='italic'>C</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
</mrow></math>

 for the derivative of a matrix
valued function 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>C</mi>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>s</mi>
<mo stretchy="false">)</mo>
</mrow></math>

 with respect to a scalar argument 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>s</mi>
</mrow></math>

.
We use the notation 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mover accent='false'><mrow><mi mathvariant='italic'>S</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
</mrow></math>

 and 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
</mrow></math>

 for the
partial derivative of a scalar value function 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mover accent='false'><mrow><mi mathvariant='italic'>F</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>S</mi>
<mo stretchy="false">,</mo>
<mi mathvariant='italic'>L</mi>
<mo stretchy="false">)</mo>
</mrow></math>


with respect to a symmetric matrix 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>S</mi>
</mrow></math>

 and
an lower triangular matrix 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>L</mi>
</mrow></math>

.
Define the scalar valued function

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<mover accent='false'><mrow><mi mathvariant='italic'>F</mi>
</mrow>
<mo stretchy='false'>&#x0005E;</mo></mover>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>C</mi>
<mo stretchy="false">)</mo>
<mo stretchy="false">=</mo>
<mover accent='false'><mrow><mi mathvariant='italic'>F</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mo stretchy="false">[</mo>
<mi mathvariant='italic'>S</mi>
<mo stretchy="false">,</mo>
<mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x0005E;</mo></mover>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>S</mi>
<mo stretchy="false">)</mo>
<mo stretchy="false">]</mo>
</mrow></math>

We use 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mover accent='false'><mrow><mi mathvariant='italic'>S</mi>
</mrow>
<mo stretchy='false'>&#x0005E;</mo></mover>
</mrow></math>

 for the total derivative of 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mover accent='false'><mrow><mi mathvariant='italic'>F</mi>
</mrow>
<mo stretchy='false'>&#x0005E;</mo></mover>
</mrow></math>

 with
respect to 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>S</mi>
</mrow></math>

.
Suppose that 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x0005E;</mo></mover>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>S</mi>
<mo stretchy="false">)</mo>
</mrow></math>

 is such that

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mo stretchy="false">=</mo>
<msub><mi mathvariant='italic'>L</mi>
<mn>0</mn>
</msub>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>low</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
<mover accent='false'><mrow><mi mathvariant='italic'>S</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mo stretchy="false">-</mo>
<mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">)</mo>
</mrow></math>

for any 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>S</mi>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>s</mi>
<mo stretchy="false">)</mo>
</mrow></math>

. It follows that

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<mover accent='false'><mrow><mi mathvariant='italic'>S</mi>
</mrow>
<mo stretchy='false'>&#x0005E;</mo></mover>
<mo stretchy="false">=</mo>
<mover accent='false'><mrow><mi mathvariant='italic'>S</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mo stretchy="false">+</mo>
<mfrac><mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>M</mi>
<mo stretchy="false">+</mo>
<msup><mi mathvariant='italic'>M</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msup>
<mo stretchy="false">)</mo>
</mrow></math>

where

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<mi mathvariant='italic'>M</mi>
<mo stretchy="false">=</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mo stretchy="false">-</mo>
<mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>low</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<msup><mo stretchy="false">)</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msup>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
</mrow></math>

<br/>
<b><a name="Lemma 1.Proof" id="Lemma 1.Proof">Proof</a></b>


<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msub><mo stretchy="false">&#x02202;</mo>
<mi mathvariant='italic'>s</mi>
</msub>
<mover accent='false'><mrow><mi mathvariant='italic'>F</mi>
</mrow>
<mo stretchy='false'>&#x0005E;</mo></mover>
<mo stretchy="false">[</mo>
<mi mathvariant='italic'>S</mi>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>s</mi>
<mo stretchy="false">)</mo>
<mo stretchy="false">,</mo>
<mi mathvariant='italic'>L</mi>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>s</mi>
<mo stretchy="false">)</mo>
<mo stretchy="false">]</mo>
<mo stretchy="false">=</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>tr</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msup><mover accent='false'><mrow><mi mathvariant='italic'>S</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msup>
<mover accent='false'><mrow><mi mathvariant='italic'>S</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mo stretchy="false">)</mo>
<mo stretchy="false">+</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>tr</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msup><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msup>
<mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mo stretchy="false">)</mo>
</mrow></math>


<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>tr</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msup><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msup>
<mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mo stretchy="false">)</mo>
<mo stretchy="false">=</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>tr</mi>
</mstyle></mrow>
<mo stretchy="false">[</mo>
<msup><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msup>
<msub><mi mathvariant='italic'>L</mi>
<mn>0</mn>
</msub>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>low</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
<mover accent='false'><mrow><mi mathvariant='italic'>S</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mo stretchy="false">-</mo>
<mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">)</mo>
<mo stretchy="false">]</mo>
</mrow></math>


<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<mo stretchy="false">=</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>tr</mi>
</mstyle></mrow>
<mo stretchy="false">[</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>low</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
<mover accent='false'><mrow><mi mathvariant='italic'>S</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mo stretchy="false">-</mo>
<mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<msup><mo stretchy="false">)</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msup>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mo stretchy="false">]</mo>
</mrow></math>


<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<mo stretchy="false">=</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>tr</mi>
</mstyle></mrow>
<mo stretchy="false">[</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
<mover accent='false'><mrow><mi mathvariant='italic'>S</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mo stretchy="false">-</mo>
<mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>low</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mo stretchy="false">)</mo>
<mo stretchy="false">]</mo>
</mrow></math>


<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<mo stretchy="false">=</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>tr</mi>
</mstyle></mrow>
<mo stretchy="false">[</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mo stretchy="false">-</mo>
<mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>low</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mo stretchy="false">)</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
<mover accent='false'><mrow><mi mathvariant='italic'>S</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mo stretchy="false">]</mo>
</mrow></math>


<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msub><mo stretchy="false">&#x02202;</mo>
<mi mathvariant='italic'>s</mi>
</msub>
<mover accent='false'><mrow><mi mathvariant='italic'>F</mi>
</mrow>
<mo stretchy='false'>&#x0005E;</mo></mover>
<mo stretchy="false">[</mo>
<mi mathvariant='italic'>S</mi>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>s</mi>
<mo stretchy="false">)</mo>
<mo stretchy="false">,</mo>
<mi mathvariant='italic'>L</mi>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>s</mi>
<mo stretchy="false">)</mo>
<mo stretchy="false">]</mo>
<mo stretchy="false">=</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>tr</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msup><mover accent='false'><mrow><mi mathvariant='italic'>S</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msup>
<mover accent='false'><mrow><mi mathvariant='italic'>S</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mo stretchy="false">)</mo>
<mo stretchy="false">+</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>tr</mi>
</mstyle></mrow>
<mo stretchy="false">[</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mo stretchy="false">-</mo>
<mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>low</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mo stretchy="false">)</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
<mover accent='false'><mrow><mi mathvariant='italic'>S</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mo stretchy="false">]</mo>
</mrow></math>

We now consider the 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>i</mi>
<mo stretchy="false">,</mo>
<mi mathvariant='italic'>j</mi>
<mo stretchy="false">)</mo>
</mrow></math>

 component function,
for a symmetric matrix 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>S</mi>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>s</mi>
<mo stretchy="false">)</mo>
</mrow></math>

,
defined by

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msub><mi mathvariant='italic'>S</mi>
<mrow><mi mathvariant='italic'>k</mi>
<mo stretchy="false">,</mo>
<mo stretchy="false">&#x02113;</mo>
</mrow>
</msub>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>s</mi>
<mo stretchy="false">)</mo>
<mo stretchy="false">=</mo>
<mrow><mo stretchy="true">{</mo><mrow><mtable rowalign="center" ><mtr><mtd columnalign="left" >
<mn>1</mn>
</mtd><mtd columnalign="left" >
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>if</mi>
</mstyle></mrow>
<mspace width='.3em'/>
<mi mathvariant='italic'>k</mi>
<mo stretchy="false">=</mo>
<mi mathvariant='italic'>i</mi>
<mspace width='.3em'/>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>and</mi>
</mstyle></mrow>
<mspace width='.3em'/>
<mo stretchy="false">&#x02113;</mo>
<mo stretchy="false">=</mo>
<mi mathvariant='italic'>j</mi>
</mtd></mtr><mtr><mtd columnalign="left" >
<mn>1</mn>
</mtd><mtd columnalign="left" >
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>if</mi>
</mstyle></mrow>
<mspace width='.3em'/>
<mi mathvariant='italic'>k</mi>
<mo stretchy="false">=</mo>
<mi mathvariant='italic'>j</mi>
<mspace width='.3em'/>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>and</mi>
</mstyle></mrow>
<mspace width='.3em'/>
<mo stretchy="false">&#x02113;</mo>
<mo stretchy="false">=</mo>
<mi mathvariant='italic'>i</mi>
</mtd></mtr><mtr><mtd columnalign="left" >
<mn>0</mn>
</mtd><mtd columnalign="left" >
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>otherwise</mi>
</mstyle></mrow>
</mtd></mtr></mtable>
</mrow><mo stretchy="true">}</mo></mrow>
</mrow></math>

This shows that the formula in the lemma is correct for

<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>S</mi>
</mrow>
<mo stretchy='false'>&#x0005E;</mo></mover>
<mrow><mi mathvariant='italic'>i</mi>
<mo stretchy="false">,</mo>
<mi mathvariant='italic'>j</mi>
</mrow>
</msub>
</mrow></math>

 and 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>S</mi>
</mrow>
<mo stretchy='false'>&#x0005E;</mo></mover>
<mrow><mi mathvariant='italic'>j</mi>
<mo stretchy="false">,</mo>
<mi mathvariant='italic'>i</mi>
</mrow>
</msub>
</mrow></math>

.
This completes the proof because the component 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>i</mi>
<mo stretchy="false">,</mo>
<mi mathvariant='italic'>j</mi>
<mo stretchy="false">)</mo>
</mrow></math>

 was arbitrary.

<br/>
<br/>
<b><big><a name="Lemma 2" id="Lemma 2">Lemma 2</a></big></b>
<br/>
We use the same assumptions as in Lemma 1 except that the
matrix 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>S</mi>
</mrow></math>

 is lower triangular (instead of symmetric).
It follows that

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<mover accent='false'><mrow><mi mathvariant='italic'>S</mi>
</mrow>
<mo stretchy='false'>&#x0005E;</mo></mover>
<mo stretchy="false">=</mo>
<mover accent='false'><mrow><mi mathvariant='italic'>S</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mo stretchy="false">+</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>lower</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>M</mi>
<mo stretchy="false">)</mo>
</mrow></math>

where

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<mi mathvariant='italic'>M</mi>
<mo stretchy="false">=</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mo stretchy="false">-</mo>
<mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>low</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<msup><mo stretchy="false">)</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msup>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
</mrow></math>

The proof of this lemma is identical to Lemma 2 except that component function
is defined by

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msub><mi mathvariant='italic'>S</mi>
<mrow><mi mathvariant='italic'>k</mi>
<mo stretchy="false">,</mo>
<mo stretchy="false">&#x02113;</mo>
</mrow>
</msub>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>s</mi>
<mo stretchy="false">)</mo>
<mo stretchy="false">=</mo>
<mrow><mo stretchy="true">{</mo><mrow><mtable rowalign="center" ><mtr><mtd columnalign="left" >
<mn>1</mn>
</mtd><mtd columnalign="left" >
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>if</mi>
</mstyle></mrow>
<mspace width='.3em'/>
<mi mathvariant='italic'>k</mi>
<mo stretchy="false">=</mo>
<mi mathvariant='italic'>i</mi>
<mspace width='.3em'/>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>and</mi>
</mstyle></mrow>
<mspace width='.3em'/>
<mo stretchy="false">&#x02113;</mo>
<mo stretchy="false">=</mo>
<mi mathvariant='italic'>j</mi>
</mtd></mtr><mtr><mtd columnalign="left" >
<mn>0</mn>
</mtd><mtd columnalign="left" >
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>otherwise</mi>
</mstyle></mrow>
</mtd></mtr></mtable>
</mrow><mo stretchy="true">}</mo></mrow>
</mrow></math>

<br/>
<b><big><a name="Reverse Mode" id="Reverse Mode">Reverse Mode</a></big></b>


<br/>
<br/>
<b><a name="Reverse Mode.Case k = 0" id="Reverse Mode.Case k = 0">Case k = 0</a></b>
<br/>
For the case 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>k</mi>
<mo stretchy="false">=</mo>
<mn>0</mn>
</mrow></math>

,

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>A</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
</msub>
<mo stretchy="false">=</mo>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
</msub>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">+</mo>
<msub><mi mathvariant='italic'>L</mi>
<mn>0</mn>
</msub>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
</mrow></math>


<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>A</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
</msub>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mo stretchy="false">-</mo>
<mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">=</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
</msub>
<mo stretchy="false">+</mo>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mo stretchy="false">-</mo>
<mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
</mrow></math>


<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>low</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>A</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
</msub>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mo stretchy="false">-</mo>
<mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">)</mo>
<mo stretchy="false">=</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
</msub>
</mrow></math>


<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
</msub>
<mo stretchy="false">=</mo>
<msub><mi mathvariant='italic'>L</mi>
<mn>0</mn>
</msub>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>low</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>A</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
</msub>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mo stretchy="false">-</mo>
<mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">)</mo>
</mrow></math>

It follows from Lemma 1 that

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>A</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mn>0</mn>
</msub>
<mover><mrow><mo stretchy="false">=</mo>
</mrow>
<mrow><mo stretchy="false">+</mo>
</mrow>
</mover>
<mfrac><mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>M</mi>
<mo stretchy="false">+</mo>
<msup><mi mathvariant='italic'>M</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msup>
<mo stretchy="false">)</mo>
</mrow></math>

where

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<mi mathvariant='italic'>M</mi>
<mo stretchy="false">=</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mo stretchy="false">-</mo>
<mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>low</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mn>0</mn>
</msub>
<msup><mo stretchy="false">)</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msup>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
</mrow></math>

and 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>A</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mn>0</mn>
</msub>
</mrow></math>

 is the partial before and after
is before and after 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<msub><mi mathvariant='italic'>L</mi>
<mn>0</mn>
</msub>
</mrow></math>

 is removed from the scalar function
dependency.

<br/>
<br/>
<b><a name="Reverse Mode.Case k &gt; 0" id="Reverse Mode.Case k &gt; 0">Case k &gt; 0</a></b>
<br/>
In the case where 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>k</mi>
<mo stretchy="false">&gt;</mo>
<mn>0</mn>
</mrow></math>

,

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msub><mi mathvariant='italic'>A</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">=</mo>
<msub><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">+</mo>
<msub><mi mathvariant='italic'>L</mi>
<mn>0</mn>
</msub>
<msubsup><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">+</mo>
<msub><mi mathvariant='italic'>B</mi>
<mi mathvariant='italic'>k</mi>
</msub>
</mrow></math>

where 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<msub><mi mathvariant='italic'>B</mi>
<mi mathvariant='italic'>k</mi>
</msub>
</mrow></math>

 is defined in terms of Taylor coefficients
of 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>L</mi>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>t</mi>
<mo stretchy="false">)</mo>
</mrow></math>

 that have order less than 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mi mathvariant='italic'>k</mi>
</mrow></math>

.
It follows that

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">+</mo>
<msub><mi mathvariant='italic'>L</mi>
<mn>0</mn>
</msub>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">=</mo>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>A</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">-</mo>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">-</mo>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
</msub>
<msubsup><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">-</mo>
<msub><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
</mrow></math>


<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">+</mo>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mo stretchy="false">-</mo>
<mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">=</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
<mo stretchy="false">(</mo>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>A</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">-</mo>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">-</mo>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
</msub>
<msubsup><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">-</mo>
<msub><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">)</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mo stretchy="false">-</mo>
<mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
</mrow></math>


<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">=</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>low</mi>
</mstyle></mrow>
<mo stretchy="false">[</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
<mo stretchy="false">(</mo>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>A</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">-</mo>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">-</mo>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
</msub>
<msubsup><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">-</mo>
<msub><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">)</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mo stretchy="false">-</mo>
<mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">]</mo>
</mrow></math>


<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">=</mo>
<msub><mi mathvariant='italic'>L</mi>
<mn>0</mn>
</msub>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>low</mi>
</mstyle></mrow>
<mo stretchy="false">[</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
<mo stretchy="false">(</mo>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>A</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">-</mo>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">-</mo>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
</msub>
<msubsup><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">-</mo>
<msub><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">)</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mo stretchy="false">-</mo>
<mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">]</mo>
</mrow></math>

The matrix 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<msub><mi mathvariant='italic'>A</mi>
<mi mathvariant='italic'>k</mi>
</msub>
</mrow></math>

 is symmetric, it follows that

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>A</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<mover><mrow><mo stretchy="false">=</mo>
</mrow>
<mrow><mo stretchy="false">+</mo>
</mrow>
</mover>
<mfrac><mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<mo stretchy="false">(</mo>
<msub><mi mathvariant='italic'>M</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">+</mo>
<msubsup><mi mathvariant='italic'>M</mi>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">)</mo>
</mrow></math>

where

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msub><mi mathvariant='italic'>M</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">=</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mo stretchy="false">-</mo>
<mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>low</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<msup><mo stretchy="false">)</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msup>
<msubsup><mi mathvariant='italic'>L</mi>
<mn>0</mn>
<mrow><mn>-1</mn>
</mrow>
</msubsup>
</mrow></math>

The matrix 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<msub><mi mathvariant='italic'>B</mi>
<mi mathvariant='italic'>k</mi>
</msub>
</mrow></math>

 is also symmetric, hence

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">=</mo>
<mo stretchy="false">-</mo>
<mspace width='.3em'/>
<mfrac><mrow><mn>1</mn>
</mrow>
<mrow><mn>2</mn>
</mrow>
</mfrac>
<mo stretchy="false">(</mo>
<msub><mi mathvariant='italic'>M</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">+</mo>
<msubsup><mi mathvariant='italic'>M</mi>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">)</mo>
</mrow></math>

We define the symmetric matrix 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<msub><mi mathvariant='italic'>C</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">(</mo>
<mi mathvariant='italic'>s</mi>
<mo stretchy="false">)</mo>
</mrow></math>

 by

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>C</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">=</mo>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
</msub>
<msubsup><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">+</mo>
<msub><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
</mrow></math>

and remove the dependency on 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<msub><mi mathvariant='italic'>C</mi>
<mi mathvariant='italic'>k</mi>
</msub>
</mrow></math>

 with

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>tr</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>C</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>C</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">)</mo>
<mo stretchy="false">=</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>tr</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>C</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">)</mo>
<mo stretchy="false">=</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>tr</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
</msub>
<msubsup><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">)</mo>
<mo stretchy="false">+</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>tr</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<msub><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">)</mo>
</mrow></math>


<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<mo stretchy="false">=</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>tr</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
</msub>
<mo stretchy="false">)</mo>
<mo stretchy="false">+</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>tr</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
</msub>
<mo stretchy="false">)</mo>
</mrow></math>


<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<mo stretchy="false">=</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>tr</mi>
</mstyle></mrow>
<mo stretchy="false">[</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">(</mo>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">+</mo>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">)</mo>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mn>0</mn>
</msub>
<mo stretchy="false">]</mo>
</mrow></math>

Thus, removing 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<msub><mi mathvariant='italic'>C</mi>
<mi mathvariant='italic'>k</mi>
</msub>
</mrow></math>

 from the dependency results in the
following update to 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mn>0</mn>
</msub>
</mrow></math>

:

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mn>0</mn>
</msub>
<mover><mrow><mo stretchy="false">=</mo>
</mrow>
<mrow><mo stretchy="false">+</mo>
</mrow>
</mover>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>lower</mi>
</mstyle></mrow>
<mo stretchy="false">[</mo>
<mo stretchy="false">(</mo>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">+</mo>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">)</mo>
<msub><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">]</mo>
</mrow></math>

which is the same as

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mn>0</mn>
</msub>
<mover><mrow><mo stretchy="false">=</mo>
</mrow>
<mrow><mo stretchy="false">+</mo>
</mrow>
</mover>
<mn>2</mn>
<mspace width='.3em'/>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>lower</mi>
</mstyle></mrow>
<mo stretchy="false">[</mo>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<msub><mi mathvariant='italic'>L</mi>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">]</mo>
</mrow></math>

We still need to remove 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<msub><mi mathvariant='italic'>B</mi>
<mi mathvariant='italic'>k</mi>
</msub>
</mrow></math>

 from the dependency.
It follows from its definition that

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">=</mo>
<munderover><mo displaystyle='true' largeop='true'>&#x02211;</mo>
<mrow><mo stretchy="false">&#x02113;</mo>
<mo stretchy="false">=</mo>
<mn>1</mn>
</mrow>
<mrow><mi mathvariant='italic'>k</mi>
<mn>-1</mn>
</mrow>
</munderover>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mo stretchy="false">&#x02113;</mo>
</msub>
<msubsup><mi mathvariant='italic'>L</mi>
<mrow><mi mathvariant='italic'>k</mi>
<mo stretchy="false">-</mo>
<mo stretchy="false">&#x02113;</mo>
</mrow>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">+</mo>
<msub><mi mathvariant='italic'>L</mi>
<mo stretchy="false">&#x02113;</mo>
</msub>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mrow><mi mathvariant='italic'>k</mi>
<mo stretchy="false">-</mo>
<mo stretchy="false">&#x02113;</mo>
</mrow>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
</mrow></math>


<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>tr</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">)</mo>
<mo stretchy="false">=</mo>
<munderover><mo displaystyle='true' largeop='true'>&#x02211;</mo>
<mrow><mo stretchy="false">&#x02113;</mo>
<mo stretchy="false">=</mo>
<mn>1</mn>
</mrow>
<mrow><mi mathvariant='italic'>k</mi>
<mn>-1</mn>
</mrow>
</munderover>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>tr</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mo stretchy="false">&#x02113;</mo>
</msub>
<msubsup><mi mathvariant='italic'>L</mi>
<mrow><mi mathvariant='italic'>k</mi>
<mo stretchy="false">-</mo>
<mo stretchy="false">&#x02113;</mo>
</mrow>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">)</mo>
<mo stretchy="false">+</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>tr</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<msub><mi mathvariant='italic'>L</mi>
<mo stretchy="false">&#x02113;</mo>
</msub>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mrow><mi mathvariant='italic'>k</mi>
<mo stretchy="false">-</mo>
<mo stretchy="false">&#x02113;</mo>
</mrow>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<mo stretchy="false">)</mo>
</mrow></math>


<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<mo stretchy="false">=</mo>
<munderover><mo displaystyle='true' largeop='true'>&#x02211;</mo>
<mrow><mo stretchy="false">&#x02113;</mo>
<mo stretchy="false">=</mo>
<mn>1</mn>
</mrow>
<mrow><mi mathvariant='italic'>k</mi>
<mn>-1</mn>
</mrow>
</munderover>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>tr</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mrow><mi mathvariant='italic'>k</mi>
<mo stretchy="false">-</mo>
<mo stretchy="false">&#x02113;</mo>
</mrow>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mo stretchy="false">&#x02113;</mo>
</msub>
<mo stretchy="false">)</mo>
<mo stretchy="false">+</mo>
<munderover><mo displaystyle='true' largeop='true'>&#x02211;</mo>
<mrow><mo stretchy="false">&#x02113;</mo>
<mo stretchy="false">=</mo>
<mn>1</mn>
</mrow>
<mrow><mi mathvariant='italic'>k</mi>
<mn>-1</mn>
</mrow>
</munderover>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>tr</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mo stretchy="false">&#x02113;</mo>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mrow><mi mathvariant='italic'>k</mi>
<mo stretchy="false">-</mo>
<mo stretchy="false">&#x02113;</mo>
</mrow>
</msub>
<mo stretchy="false">)</mo>
</mrow></math>

We now use the fact that 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
</mrow></math>

 is symmetric to conclude

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>tr</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<mo stretchy="false">)</mo>
<mo stretchy="false">=</mo>
<mn>2</mn>
<munderover><mo displaystyle='true' largeop='true'>&#x02211;</mo>
<mrow><mo stretchy="false">&#x02113;</mo>
<mo stretchy="false">=</mo>
<mn>1</mn>
</mrow>
<mrow><mi mathvariant='italic'>k</mi>
<mn>-1</mn>
</mrow>
</munderover>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>tr</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msubsup><mi mathvariant='italic'>L</mi>
<mrow><mi mathvariant='italic'>k</mi>
<mo stretchy="false">-</mo>
<mo stretchy="false">&#x02113;</mo>
</mrow>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<msubsup><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mi mathvariant='italic'>k</mi>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>T</mi>
</mstyle></mrow>
</msubsup>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mo stretchy="false">&#x02113;</mo>
</msub>
<mo stretchy="false">)</mo>
</mrow></math>

Each of the 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x002D9;</mo></mover>
<mo stretchy="false">&#x02113;</mo>
</msub>
</mrow></math>

 matrices is lower triangular.
Thus, removing 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<msub><mi mathvariant='italic'>B</mi>
<mi mathvariant='italic'>k</mi>
</msub>
</mrow></math>

 from the dependency results in the following
update for 
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow>
<mo stretchy="false">&#x02113;</mo>
<mo stretchy="false">=</mo>
<mn>1</mn>
<mo stretchy="false">,</mo>
<mo stretchy="false">&#x02026;</mo>
<mo stretchy="false">,</mo>
<mi mathvariant='italic'>k</mi>
<mn>-1</mn>
</mrow></math>

:

<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>L</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mo stretchy="false">&#x02113;</mo>
</msub>
<mover><mrow><mo stretchy="false">=</mo>
</mrow>
<mrow><mo stretchy="false">+</mo>
</mrow>
</mover>
<mn>2</mn>
<mspace width='.3em'/>
<mrow><mstyle mathvariant='normal'><mi mathvariant='normal'>lower</mi>
</mstyle></mrow>
<mo stretchy="false">(</mo>
<msub><mover accent='false'><mrow><mi mathvariant='italic'>B</mi>
</mrow>
<mo stretchy='false'>&#x000AF;</mo></mover>
<mi mathvariant='italic'>k</mi>
</msub>
<msub><mi mathvariant='italic'>L</mi>
<mrow><mi mathvariant='italic'>k</mi>
<mo stretchy="false">-</mo>
<mo stretchy="false">&#x02113;</mo>
</mrow>
</msub>
<mo stretchy="false">)</mo>
</mrow></math>


<hr/>Input File: omh/appendix/theory/cholesky.omh

</body>
</html>
